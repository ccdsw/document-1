# Android P 解析vdex

本文记一次解析YouTube的vdex的过程.由于在Android P中有一种新的dex文件格式cdex,

# 0 准备文件
从机器中拷贝出文件:

```
adb pull system/app/YouTube ./
```

目录结构如下:

```
YouTube |
        |--YouTube.apk
        |--oat/arm
                  |--YouTube.odex
                  |--YouTube.vdex       
```
本例子中,要解析的文件就是`YouTube.vdex`.

# 1 解析vdex到cdex文件

需要用到一个开源工具[vdexExtractor](https://github.com/anestisb/vdexExtractor),

```
git clone https://github.com/anestisb/vdexExtractor.git
```
执行`vdexExtractor/make.sh`, 就会在产生`vdexExtractor/bin/vdexExtractor`.
使用bin文件`vdexExtractor`解析vdex文件:

```
./vdexExtractor -i ./YouTube.vdex -o ./ --deps -f
```
解析完成后会得到4个cdex文件:`YouTube_classes.cdex`,`YouTube_classes2.cdex`,`YouTube_classes3.cdex`,`YouTube_classes4.cdex`.
./compact_dex_converter YouTube_classes.cdex

dex2jar YouTube_classes.cdex.new -> ./YouTube_classes.cdex-dex2jar.jar
com.googlecode.d2j.DexException: not support version.
	at com.googlecode.d2j.reader.DexFileReader.<init>(DexFileReader.java:151)
	at com.googlecode.d2j.reader.DexFileReader.<init>(DexFileReader.java:211)
	at com.googlecode.dex2jar.tools.Dex2jarCmd.doCommandLine(Dex2jarCmd.java:104)
	at com.googlecode.dex2jar.tools.BaseCmd.doMain(BaseCmd.java:288)
	at com.googlecode.dex2jar.tools.Dex2jarCmd.main(Dex2jarCmd.java:32)

https://github.com/pxb1988/dex2jar/releases

# 2 解析cdex到dex文件
vdexExtractor






# 3 解析dex到jar

# 4 解析jar文件







